var RevealNotes=function(){function a(a){function c(){var a=setInterval(function(){b.postMessage(JSON.stringify({namespace:"reveal-notes",type:"connect",url:window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,state:Reveal.getState()}),"*")},500);window.addEventListener("message",function(b){var c=JSON.parse(b.data);c&&"reveal-notes"===c.namespace&&"connected"===c.type&&(clearInterval(a),f()),c&&"reveal-notes"===c.namespace&&"call"===c.type&&d(c.methodName,c.arguments,c.callId)})}function d(a,c,d){var e=Reveal[a].apply(Reveal,c);b.postMessage(JSON.stringify({namespace:"reveal-notes",type:"return",result:e,callId:d}),"*")}function e(a){var c=Reveal.getCurrentSlide(),d=c.querySelector("aside.notes"),e=c.querySelector(".current-fragment"),f={namespace:"reveal-notes",type:"state",notes:"",markdown:!1,whitespace:"normal",state:Reveal.getState()};if(c.hasAttribute("data-notes")&&(f.notes=c.getAttribute("data-notes"),f.whitespace="pre-wrap"),e){var g=e.querySelector("aside.notes");g?d=g:e.hasAttribute("data-notes")&&(f.notes=e.getAttribute("data-notes"),f.whitespace="pre-wrap",d=null)}d&&(f.notes=d.innerHTML,f.markdown="string"==typeof d.getAttribute("data-markdown")),b.postMessage(JSON.stringify(f),"*")}function f(){Reveal.addEventListener("slidechanged",e),Reveal.addEventListener("fragmentshown",e),Reveal.addEventListener("fragmenthidden",e),Reveal.addEventListener("overviewhidden",e),Reveal.addEventListener("overviewshown",e),Reveal.addEventListener("paused",e),Reveal.addEventListener("resumed",e),e()}if(b&&!b.closed)return void b.focus();if(!a){var g=document.querySelector('script[src$="notes.js"]').src;g=g.replace(/notes\.js(\?.*)?$/,""),a=g+"notes.html"}return(b=window.open(a,"reveal.js - Notes","width=1100,height=700"))?void c():void alert("Speaker view popup failed to open. Please make sure popups are allowed and reopen the speaker view.")}var b=null;return{init:function(){/receiver/i.test(window.location.search)||(null!==window.location.search.match(/(\?|\&)notes/gi)&&a(),Reveal.addKeyBinding({keyCode:83,key:"S",description:"Speaker notes view"},function(){a()}))},open:a}}();Reveal.registerPlugin("notes",RevealNotes);